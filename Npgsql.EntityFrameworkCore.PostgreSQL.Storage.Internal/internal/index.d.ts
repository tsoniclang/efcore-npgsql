// Generated by tsbindgen - Architecture
// Namespace: Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal
// Assembly: Npgsql.EntityFrameworkCore.PostgreSQL

// Primitive type aliases from @tsonic/core
import type { sbyte, byte, short, ushort, int, uint, long, ulong, int128, uint128, half, float, double, decimal, nint, nuint, char } from '@tsonic/core/types.js';

// Import types from other namespaces
import type { INpgsqlSingletonOptions, NpgsqlOptionsExtension } from "../../Npgsql.EntityFrameworkCore.PostgreSQL.Infrastructure.Internal/internal/index.js";
import type { INpgsqlDataSourceConfigurationPlugin } from "../../Npgsql.EntityFrameworkCore.PostgreSQL.Infrastructure/internal/index.js";
import type { NpgsqlEStringTypeMapping } from "../../Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.Mapping/internal/index.js";
import type { NpgsqlConnection } from "../../Npgsql/internal/index.js";
import type { IEnumerable } from "@tsonic/dotnet/System.Collections.Generic.js";
import type { DbDataSource } from "@tsonic/dotnet/System.Data.Common.js";
import * as System_Internal from "@tsonic/dotnet/System.js";
import type { Boolean as ClrBoolean, Exception, Func, IAsyncDisposable, IDisposable, IServiceProvider, Object as ClrObject, String as ClrString, TimeSpan, Type, Void } from "@tsonic/dotnet/System.js";
import type { StringBuilder } from "@tsonic/dotnet/System.Text.js";
import type { CancellationToken } from "@tsonic/dotnet/System.Threading.js";
import type { Task, ValueTask } from "@tsonic/dotnet/System.Threading.Tasks.js";
import type { Transaction } from "@tsonic/dotnet/System.Transactions.js";
import * as Microsoft_EntityFrameworkCore_Infrastructure_Internal from "@tsonic/efcore/Microsoft.EntityFrameworkCore.Infrastructure.js";
import type { IDbContextOptions, IResettableService } from "@tsonic/efcore/Microsoft.EntityFrameworkCore.Infrastructure.js";
import type { DbContext } from "@tsonic/efcore/Microsoft.EntityFrameworkCore.js";
import type { IModel, IProperty } from "@tsonic/efcore/Microsoft.EntityFrameworkCore.Metadata.js";
import * as Microsoft_EntityFrameworkCore_Storage_Internal from "@tsonic/efcore/Microsoft.EntityFrameworkCore.Storage.js";
import type { CoreTypeMapping, ExecutionResult, ExecutionStrategyDependencies, IDatabaseCreator, IDbContextTransactionManager, IExecutionStrategy, IExecutionStrategyFactory, IRawSqlCommandBuilder, IRelationalConnection, IRelationalDatabaseCreator, IRelationalTransactionManager, IRelationalTypeMappingSource, ISqlGenerationHelper, ITransactionEnlistmentManager, ITypeMappingSource, RelationalConnection, RelationalConnectionDependencies, RelationalDatabaseCreator, RelationalDatabaseCreatorDependencies, RelationalExecutionStrategyFactory, RelationalSqlGenerationHelper, RelationalSqlGenerationHelperDependencies, RelationalTypeMapping, RelationalTypeMappingSource, RelationalTypeMappingSourceDependencies, TypeMappingSourceDependencies } from "@tsonic/efcore/Microsoft.EntityFrameworkCore.Storage.js";

export interface INpgsqlRelationalConnection$instance extends IRelationalConnection, IRelationalTransactionManager, IDbContextTransactionManager, IResettableService, IDisposable, IAsyncDisposable {
    readonly dataSource: DbDataSource | undefined;
    cloneWith(connectionString: string, async: boolean, cancellationToken?: CancellationToken): ValueTask<INpgsqlRelationalConnection>;
    createAdminConnection(): INpgsqlRelationalConnection;
}


export type INpgsqlRelationalConnection = INpgsqlRelationalConnection$instance;

export interface NpgsqlDatabaseCreator$instance extends RelationalDatabaseCreator {
    retryDelay: TimeSpan;
    retryTimeout: TimeSpan;
    create(): void;
    createAsync(cancellationToken?: CancellationToken): Task;
    createTables(): void;
    createTablesAsync(cancellationToken?: CancellationToken): Task;
    delete(): void;
    deleteAsync(cancellationToken?: CancellationToken): Task;
    exists(): boolean;
    existsAsync(cancellationToken?: CancellationToken): Task<System_Internal.Boolean>;
    hasTables(): boolean;
    hasTablesAsync(cancellationToken?: CancellationToken): Task<System_Internal.Boolean>;
}


export const NpgsqlDatabaseCreator: {
    new(dependencies: RelationalDatabaseCreatorDependencies, connection: INpgsqlRelationalConnection, rawSqlCommandBuilder: IRawSqlCommandBuilder): NpgsqlDatabaseCreator;
};


export type NpgsqlDatabaseCreator = NpgsqlDatabaseCreator$instance;

export interface NpgsqlDataSourceManager$instance {
    dispose(): void;
    disposeAsync(): ValueTask;
    getDataSource(npgsqlOptionsExtension: NpgsqlOptionsExtension, applicationServiceProvider: IServiceProvider): DbDataSource | undefined;
}


export const NpgsqlDataSourceManager: {
    new(plugins: IEnumerable<INpgsqlDataSourceConfigurationPlugin>): NpgsqlDataSourceManager;
};


export type NpgsqlDataSourceManager = NpgsqlDataSourceManager$instance;

export interface NpgsqlExecutionStrategy$instance {
    readonly retriesOnFailure: boolean;
    execute<TState, TResult>(state: TState, operation: Func<DbContext, TState, TResult>, verifySucceeded: Func<DbContext, TState, ExecutionResult<TResult>>): TResult;
    executeAsync<TState, TResult>(state: TState, operation: Func<DbContext, TState, CancellationToken, Task<TResult>>, verifySucceeded: Func<DbContext, TState, CancellationToken, Task<ExecutionResult<TResult>>>, cancellationToken: CancellationToken): Task<TResult>;
}


export const NpgsqlExecutionStrategy: {
    new(dependencies: ExecutionStrategyDependencies): NpgsqlExecutionStrategy;
};


export type NpgsqlExecutionStrategy = NpgsqlExecutionStrategy$instance;

export interface NpgsqlExecutionStrategyFactory$instance extends RelationalExecutionStrategyFactory {
}


export const NpgsqlExecutionStrategyFactory: {
    new(dependencies: ExecutionStrategyDependencies): NpgsqlExecutionStrategyFactory;
};


export type NpgsqlExecutionStrategyFactory = NpgsqlExecutionStrategyFactory$instance;

export interface NpgsqlRelationalConnection$instance extends RelationalConnection {
    connectionString: string;
    readonly currentAmbientTransaction: Transaction | undefined;
    readonly dataSource: DbDataSource | undefined;
    dbConnection: NpgsqlConnection;
    get dbDataSource(): DbDataSource | undefined;
    set dbDataSource(value: DbDataSource);
    cloneWith(connectionString: string, async: boolean, cancellationToken?: CancellationToken): ValueTask<INpgsqlRelationalConnection>;
    createAdminConnection(): INpgsqlRelationalConnection;
}


export const NpgsqlRelationalConnection: {
    new(dependencies: RelationalConnectionDependencies, dataSourceManager: NpgsqlDataSourceManager, options: IDbContextOptions): NpgsqlRelationalConnection;
};


export interface __NpgsqlRelationalConnection$views {
    As_INpgsqlRelationalConnection(): INpgsqlRelationalConnection$instance;
}

export interface NpgsqlRelationalConnection$instance extends INpgsqlRelationalConnection$instance {}

export type NpgsqlRelationalConnection = NpgsqlRelationalConnection$instance & __NpgsqlRelationalConnection$views;


export interface NpgsqlSqlGenerationHelper$instance extends RelationalSqlGenerationHelper {
    delimitIdentifier(identifier: string): string;
    delimitIdentifier(builder: StringBuilder, identifier: string): void;
}


export const NpgsqlSqlGenerationHelper: {
    new(dependencies: RelationalSqlGenerationHelperDependencies): NpgsqlSqlGenerationHelper;
};


export type NpgsqlSqlGenerationHelper = NpgsqlSqlGenerationHelper$instance;

export interface NpgsqlTransientExceptionDetector$instance {
}


export const NpgsqlTransientExceptionDetector: {
    new(): NpgsqlTransientExceptionDetector;
    shouldRetryOn(ex: Exception): boolean;
};


export type NpgsqlTransientExceptionDetector = NpgsqlTransientExceptionDetector$instance;

export interface NpgsqlTypeMappingSource$instance extends RelationalTypeMappingSource {
    readonly eStringTypeMapping: NpgsqlEStringTypeMapping;
    findCollectionMapping(storeType: string, modelClrType: Type, providerClrType: Type, elementMapping: CoreTypeMapping): RelationalTypeMapping | undefined;
    findContainerMapping(containerClrType: Type, containeeTypeMapping: RelationalTypeMapping, model: IModel): RelationalTypeMapping | undefined;
    findMapping(property: IProperty): RelationalTypeMapping | undefined;
}


export const NpgsqlTypeMappingSource: {
    new(dependencies: TypeMappingSourceDependencies, relationalDependencies: RelationalTypeMappingSourceDependencies, sqlGenerationHelper: ISqlGenerationHelper, options: INpgsqlSingletonOptions): NpgsqlTypeMappingSource;
};


export type NpgsqlTypeMappingSource = NpgsqlTypeMappingSource$instance;

